<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>高校实验室管理系统</title>
  <link rel="stylesheet" href="../../../css/layui.css" media="all">
  <style>
    .layui-form {
      padding: 20px 10px;
    }
  </style>
</head>

<body>
  <form class="layui-form" action="">
    <div class="layui-form-item">
      <label class="layui-form-label">选择轮播图</label>
      <div class="layui-input-inline">
        <select name="modules" lay-verify="required" lay-search="">
          <option value="">请选择轮播图</option>
          <option value="1">轮播图一</option>
          <option value="2">轮播图二</option>
          <option value="3">轮播图三</option>
        </select>
      </div>
    </div>
    <div class="layui-form-item ">
      <label class="layui-form-label">图片上传</label>
      <div class="layui-input-block">
        <button type="button" class="layui-btn" id="test1">
          <i class="layui-icon">&#xe67c;</i>上传图片
        </button>
        <div class="layui-inline layui-word-aux"></div>
        这里以限制1024kb为例
      </div>
    </div>
    <div class="layui-form-item">
      <div class="layui-input-block">
        <img src="" alt="" id="preview" style="width: 600px;">
      </div>
    </div>
    <input type="hidden" id="img" name="src">
    <div class="layui-form-item layui-form-text">
      <label class="layui-form-label">描述</label>
      <div class="layui-input-block">
        <textarea name="describe" placeholder="请输入图片描述" lay-verify="required"  class="layui-textarea"></textarea>
      </div>
    </div>

    <div class="layui-form-item">
      <div class="layui-input-block">
        <button type="submit" class="layui-btn" lay-submit lay-filter="formDemo">立即提交</button>
        <button type="reset" class="layui-btn layui-btn-primary">重置</button>
      </div>

    </div>
  </form>
  <script src="../../../layui.js" charset="utf-8"></script>
  <script>
    layui.use(['form', 'upload', 'jquery'], function () {
      var layer = layui.layer;
      var upload = layui.upload;
      var $ = layui.jquery;
      var form=layui.form;


      //自定义验证规则
      // form.verify({
      //   // title: function(value){
      //   //   if(value.length < 5){
      //   //     return '标题至少得5个字符啊';
      //   //   }
      //   // }
      //   pass: [
      //     /^[\S]{6,12}$/
      //     ,'密码必须6到12位，且不能出现空格'
      //   ]
      //   ,content: function(value){
      //     layedit.sync(editIndex);
      //   }
      // });
      //监听提交

      var uploadInst = upload.render({
        elem: '#test1' //绑定元素
        ,
        url: 'http://httpbin.org/post' //上传接口
        ,
        field: 'src'
        ,
        done: function (res) {
          console.log(res);
          //上传完毕回调
          $("#img").val(res.data.src);
          $("#preview").attr("src", res.data.src);
          layer.msg('上传成功', { icon: 6 }); //eg3
        }
        ,
        error: function () {
          //请求异常回调
        }
      });
      form.on('submit(formDemo)', function (data) {
        console.log(data.field);
      });

    });

  </script>
</body>

</html>