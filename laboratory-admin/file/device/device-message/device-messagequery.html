<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>高校实验室管理 </title>
    <meta name="keywords" content="高校实验室管理系统" />
    <meta name="description" content="高校实验室管理系统" />
    <link rel="stylesheet" href="./css/layui.css">
    <script src="./js/jquery-3.4.1.js"></script>
    <script src="./js/table2.js"></script>
    <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"
        integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"
        integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
        crossorigin="anonymous"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.16.0/dist/bootstrap-table.min.css">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://unpkg.com/bootstrap-table@1.16.0/dist/bootstrap-table.min.js"></script>
    <!-- Latest compiled and minified Locales -->
    <!-- <script src="https://unpkg.com/bootstrap-table@1.16.0/dist/locale/bootstrap-table-zh-CN.min.js"></script> -->
    <link rel="stylesheet" href="./css/device.css">
</head>

<body>
    <div id="app">
        <div class="layui-form">
            <table class="table table-hover" style="height: 350px;">

                <thead>
                    <tr v-if="headdata.length">
                        <!-- <th v-for="item in headdata" :key="'headdata'+item.id">{{item.names}}</th> -->
                        <th>设备编号</th>
                        <th>设备信息</th>
                        <th>设备信息</th>
                        <th>设备信息</th>
                        <th>设备信息</th>
                        <th>设备信息</th>
                        <th>设备信息</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-if="devicedata.length">
                        <!-- <td v-for="item in devicedata" :key="'devicedata'+item.id">{{item.names}}</td> -->
                        <td>1</td>
                        <td>服务器</td>
                        <td>联想万全R520(Xeon563)</td>
                        <td>1</td>
                        <td>401</td>
                        <td>118815224</td>
                        <td>2010-11-11</td>
                        <td>15825874111</td>
                        <td>15825874111</td>
                        <td style="width: 200px;">
                            <button type="button" class="layui-btn layui-btn-sm layui-btn-normal c">
                                <!-- <i class="layui-icon">&#xe654;</i> -->
                                查看
                            </button>
                            <!--   <button type="button" class="layui-btn layui-btn-sm">
                                <i class="layui-icon">&#xe642;</i>
                            </button> -->
                            <button type="button" class="layui-btn layui-btn-sm layui-btn-danger s"
                                @click="deletedevicedata(item.id)">
                                <!-- <i class="layui-icon">&#xe640;</i> -->
                                删除
                            </button>

                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <script src="./js/vue.js"></script>
    <script src="./layui.js"></script>
    <!--先加载jquery-->
    <!-- <script src="./js/jquery-3.4.1.js"></script> -->
    <!--再加载插件-->
    <script src="./js/layui_exts/excel.js"></script>
    <script>
        let vm = new Vue({
            el: '#app',
            data: {

                headdata: [
                    { id: 1, names: '设备编号' },
                    { id: 3, names: '设备名称' },
                    { id: 4, names: '品牌名称' },
                    { id: 8, names: '出厂编号' },
                    { id: 9, names: '出厂日期' },
                    { id: 10, names: '生产厂商编号' },
                    { id: 11, names: '供应商编号' },
                ],
                devicedata: [
                    {
                        id: 1,
                        names: '服务器',
                        brand: '戴尔（DELL）Poweredge R740 ',
                        conid: '已使用',
                        roomnames: '电商实验室',
                        facid: 'CA02201910251',
                        factime: '2019-10-25',
                        proid: '12689',
                        supid: '1003030',
                        uratio: '21%',
                        arate: '5%'
                    },
                    {
                        id: 2,
                        names: '电脑',
                        brand: '联想天逸510S',
                        conid: '已使用',
                        roomnames: '网络实验室',
                        facid: 'BA02201903257',
                        factime: '2019-03-25',
                        proid: '18685',
                        supid: '1105023',
                        uratio: '32%',
                        arate: '10%'
                    },

                    {
                        id: 3,
                        names: '标准投影仪',
                        brand: '极米Z6',
                        conid: '已使用',
                        roomnames: '电商实验室',
                        facid: 'AG02201711268',
                        factime: '2017-11-26',
                        proid: '79026',
                        supid: '1011283',
                        uratio: '75%',
                        arate: '55%'
                    },

                    {
                        id: 4,
                        names: '交换机',
                        brand: '华为（HUAWEI）',
                        conid: '已使用',
                        roomnames: '网络实验室',
                        facid: 'HN03201908088',
                        factime: '2019-08-08',
                        proid: '12256',
                        supid: '1110368',
                        uratio: '25%',
                        arate: '8%'
                    },

                    {
                        id: 5,
                        names: '中央处理器',
                        brand: ' 惠普（hp）',
                        conid: '已使用',
                        roomnames: '网络实验室',
                        facid: 'BY02202003257',
                        factime: '2020-03-25',
                        proid: '18795',
                        supid: '1107023',
                        uratio: '10%',
                        arate: '4%'
                    },
                    {
                        id: 6,
                        names: '防火墙',
                        brand: '思科ASA5506-K9',
                        conid: '已使用',
                        roomnames: '网络实验室',
                        facid: 'AT02202001088',
                        factime: '2020-01-08',
                        proid: '77811',
                        supid: '1209752',
                        uratio: '25%',
                        arate: '10%'
                    },

                    {
                        id: 7,
                        names: '网络设备控制器',
                        brand: ' 佐铭',
                        conid: '已使用',
                        roomnames: '网络实验室',
                        facid: 'HN03201908238',
                        factime: '2019-08-23',
                        proid: '49462',
                        supid: '1609358',
                        uratio: '30%',
                        arate: '10%'
                    },


                    {
                        id: 8,
                        names: '集线器',
                        brand: '绿联（UGREEN）',
                        conid: '已使用',
                        roomnames: '网络实验室',
                        facid: 'KJ25201811268',
                        factime: '2018-11-26',
                        proid: '46168',
                        supid: '1208719',
                        uratio: '53%',
                        arate: '29%'
                    },
                    {
                        id: 9,
                        names: '数字万用表',
                        brand: '德力西电气（DELIXI ELECTRIC）',
                        conid: '已使用',
                        roomnames: '网络实验室',
                        facid: 'YG45202003185',
                        factime: '2020-03-18',
                        proid: '45125',
                        supid: '1503557',
                        uratio: '8%',
                        arate: '2%'
                    },

                    {
                        id: 10,
                        names: '双绞线',
                        brand: '山泽SZ-5305A',
                        conid: '已使用',
                        roomnames: '网络实验室',
                        facid: 'YI89201910267',
                        factime: '2019-10-26',
                        proid: '56562',
                        supid: '1208498',
                        uratio: '45%',
                        arate: '30%'
                    },
                    {
                        id: 11,
                        names: '打印机',
                        brand: '得力M2020W',
                        conid: '已使用',
                        roomnames: '电商实验室',
                        facid: 'YH28201903089',
                        factime: '2019-03-08',
                        proid: '72263',
                        supid: '1008715',
                        uratio: '50%',
                        arate: '43%'
                    },

                    {
                        id: 12,
                        names: '电动幕布',
                        brand: '极米（XGIMI）',
                        conid: '已使用',
                        roomnames: '电商实验室',
                        facid: 'IO78201809037',
                        factime: '2018-09-03',
                        proid: '78121',
                        supid: '1012892',
                        uratio: '60%',
                        arate: '55%'
                    },
                    {
                        id: 13,
                        names: '音箱',
                        brand: '漫步者R101V',
                        conid: '已使用',
                        roomnames: '网络实验室',
                        facid: 'YC45201707208',
                        factime: '2017-07-20',
                        proid: '48451',
                        supid: '0703485',
                        uratio: '75%',
                        arate: '65%'
                    },
                    {
                        id: 14,
                        names: '配线架',
                        brand: '胜为NDF-624G',
                        conid: '已使用',
                        roomnames: '网络实验室',
                        facid: 'PO24201903189',
                        factime: '2019-03-18',
                        proid: '79451',
                        supid: '1103458',
                        uratio: '45%',
                        arate: '38%'
                    },

                    {
                        id: 15,
                        names: '电源插座',
                        brand: '公牛GN-9323D',
                        conid: '已使用',
                        roomnames: '电商实验室',
                        facid: 'YH49201708067',
                        factime: '2017-08-06',
                        proid: '78772',
                        supid: '1505887',
                        uratio: '75%',
                        arate: '70%'
                    },
                    {
                        id: 16,
                        names: '光纤收发器',
                        brand: 'netLINKHTB-',
                        conid: '已使用',
                        roomnames: '网络实验室',
                        facid: 'HJ84201904085',
                        factime: '2019-04-08',
                        proid: '78121',
                        supid: '1308426',
                        uratio: '40%',
                        arate: '25%'
                    },

                    {
                        id: 17,
                        names: '吊装支架',
                        brand: '坚果（JmGO）',
                        conid: '已使用',
                        roomnames: '电商实验室',
                        facid: 'UU78201912309',
                        factime: '2019-12-30',
                        proid: '78451',
                        supid: '1503852',
                        uratio: '15%',
                        arate: '12%'
                    },

                    {
                        id: 18,
                        names: '无线话筒',
                        brand: '麦拉达（mailada）WM8',
                        conid: '已使用',
                        roomnames: '电商实验室',
                        facid: 'UT45202004239',
                        factime: '2020-04-23',
                        proid: '78122',
                        supid: '1507155',
                        uratio: '3%',
                        arate: '1%'
                    },

                    {
                        id: 19,
                        names: '路由器',
                        brand: '华为XD20',
                        conid: '已使用',
                        roomnames: '网络实验室',
                        facid: 'TV85202001045',
                        factime: '2020-01-04',
                        proid: '46161',
                        supid: '1308420',
                        uratio: '9%',
                        arate: '3%'
                    },
                    {
                        id: 20,
                        names: '专业照相机',
                        brand: '尼康（Nikon）Z6',
                        conid: '已使用',
                        roomnames: '电商实验室',
                        facid: 'VT85201912251',
                        factime: '2019-12-25',
                        proid: '95133',
                        supid: '1205539',
                        uratio: '4%',
                        arate: '4%'
                    },
                ],

            },
            watch: {
                devicedata: function () {
                    this._save();
                },
            },
            methods: {
                initdevicedata() {

                    localStorage.setItem('devicedata', JSON.stringify(this.devicedata));

                    let devicedata = localStorage.getItem('devicedata');

                    if (devicedata) {
                        this.devicedata = JSON.parse(devicedata);
                    };
                },
                inserttodo() {
                    let id = this._lastId();
                    //拷贝
                    let todo = Object.assign({}, this.todo, { id });

                    this.todolist.push(todo);

                    this.todo = {
                        id: 0,
                        title: '',
                        ctime: '',
                        status: false,
                    };

                },
                deletedevicedata(id) {
                    this.devicedata = this.devicedata.filter(ele => ele.id != id);

                },
                _lastId() {
                    let todolist = this.todolist;
                    let id = 1;
                    if (todolist.length) {
                        id = todolist[todolist.length - 1].id + 1;
                    }
                    return id;
                },

                _save() {

                    let devicedata = JSON.stringify(this.devicedata);

                    localStorage.setItem('devicedata', devicedata);
                }
            },
            mounted() {
                this.initdevicedata();
            }
        })

    </script>
    <script>
        layui.config({
            base: '${base}/scripts/layui/layui_exts/'
        }).use(['excel', 'layer'], function () {
            var $ = layui.$;
            var layer = layui.layer;
            var excel = layui.excel;
            $('#exportExcel').on('click', function () {
                var data = [
                    {
                        id: {
                            v: '实验室设备使用率及损耗率报告', s: {
                                alignment: {
                                    horizontal: 'center',
                                    vertical: 'center'
                                },
                                // fill: { bgColor: { indexed: 64 }, fgColor: { rgb: "FFFFFF" } }
                            }
                        }, names: '', brand: '', conid: '', uratio: ''
                    },// 被合并的列数据也需要填充上
                    {
                        id: {
                            v: '1.设备使用率', s: {
                                alignment: {
                                    //    horizontal: 'center',
                                    vertical: 'center'
                                },
                                fill: { bgColor: { indexed: 64 }, fgColor: { rgb: "99CCFF" } } // { rgb: "f4ea2a" }

                            }
                        }, names: '', brand: '', conid: '', uratio: ''
                    },
                    { id: "设备编号", names: '设备名称', brand: '品牌名称', conid: '设备状态', uratio: '使用率' },
                    { id: 1, names: '服务器', brand: '戴尔（DELL）Poweredge R740 ', conid: '已使用', uratio: '21%' },
                    { id: 2, names: '电脑', brand: '联想天逸510S', conid: '已使用', uratio: '32%' },
                    { id: 3, names: '标准投影仪', brand: '极米Z6', conid: '已使用', uratio: '75%' },
                    { id: 4, names: '交换机', brand: '华为（HUAWEI）', conid: '已使用', uratio: '25%' },
                    { id: 5, names: '中央处理器', brand: '惠普（hp）', conid: '已使用', uratio: '10%' },
                    { id: 6, names: '防火墙', brand: '思科ASA5506-K9', conid: '已使用', uratio: '25%' },
                    { id: 7, names: '网络设备控制器', brand: '佐铭', conid: '已使用', uratio: '30%' },
                    { id: 8, names: '集线器', brand: '绿联（UGREEN）', conid: '已使用', uratio: '53%' },
                    { id: 9, names: '数字万用表', brand: '德力西电气（DELIXI ELECTRIC）', conid: '已使用', uratio: '8%' },
                    { id: 10, names: '双绞线', brand: '山泽SZ-5305A', conid: '已使用', uratio: '45%' },
                    { id: 11, names: '打印机', brand: '得力M2020W', conid: '已使用', uratio: '50%' },
                    { id: 12, names: '电动幕布', brand: '极米（XGIMI）', conid: '已使用', uratio: '60%' },
                    { id: 13, names: '音箱', brand: '漫步者R101V', conid: '已使用', uratio: '75%' },
                    { id: 14, names: '配线架', brand: '胜为NDF-624G', conid: '已使用', uratio: '45%' },
                    { id: 15, names: '电源插座', brand: '公牛GN-9323D', conid: '已使用', uratio: '75%' },
                    { id: 16, names: '光纤收发器', brand: 'netLINKHTB-', conid: '已使用', uratio: '40%' },
                    { id: 17, names: '吊装支架', brand: '坚果（JmGO）', conid: '已使用', uratio: '15%' },
                    { id: 18, names: '无线话筒', brand: '麦拉达（mailada）WM8', conid: '已使用', uratio: '3%' },
                    { id: 19, names: '路由器', brand: '华为XD20', conid: '已使用', uratio: '9%' },
                    { id: 20, names: '专业照相机', brand: '尼康（Nikon）Z6', conid: '已使用', uratio: '4%' },
                    {
                        id: {
                            v: '2.设备损耗率', s: {
                                alignment: {
                                    //    horizontal: 'center',
                                    vertical: 'center'
                                },
                                fill: { bgColor: { indexed: 64 }, fgColor: { rgb: "99CCFF" } } // { rgb: "f4ea2a" }
                                // fill: { bgColor: { indexed: 64 }, fgColor: { rgb: "f4ea2a" } }
                            }
                        }, names: '', brand: '', conid: '', uratio: ''
                    },
                    { id: "设备编号", names: '设备名称', brand: '品牌名称', conid: '设备状态', uratio: '损耗率' },
                    { id: 1, names: '服务器', brand: '戴尔（DELL）Poweredge R740 ', conid: '已使用', uratio: '5%' },
                    { id: 2, names: '电脑', brand: '联想天逸510S', conid: '已使用', uratio: '10%' },
                    { id: 3, names: '标准投影仪', brand: '极米Z6', conid: '已使用', uratio: '55%' },
                    { id: 4, names: '交换机', brand: '华为（HUAWEI）', conid: '已使用', uratio: '8%' },
                    { id: 5, names: '中央处理器', brand: '惠普（hp）', conid: '已使用', uratio: '4%' },
                    { id: 6, names: '防火墙', brand: '思科ASA5506-K9', conid: '已使用', uratio: '10%' },
                    { id: 7, names: '网络设备控制器', brand: '佐铭', conid: '已使用', uratio: '10%' },
                    { id: 8, names: '集线器', brand: '绿联（UGREEN）', conid: '已使用', uratio: '29%' },
                    { id: 9, names: '数字万用表', brand: '德力西电气（DELIXI ELECTRIC）', conid: '已使用', uratio: '2%' },
                    { id: 10, names: '双绞线', brand: '山泽SZ-5305A', conid: '已使用', uratio: '30%' },
                    { id: 11, names: '打印机', brand: '得力M2020W', conid: '已使用', uratio: '43%' },
                    { id: 12, names: '电动幕布', brand: '极米（XGIMI）', conid: '已使用', uratio: '55%' },
                    { id: 13, names: '音箱', brand: '漫步者R101V', conid: '已使用', uratio: '65%' },
                    { id: 14, names: '配线架', brand: '胜为NDF-624G', conid: '已使用', uratio: '38%' },
                    { id: 15, names: '电源插座', brand: '公牛GN-9323D', conid: '已使用', uratio: '70%' },
                    { id: 16, names: '光纤收发器', brand: 'netLINKHTB-', conid: '已使用', uratio: '25%' },
                    { id: 17, names: '吊装支架', brand: '坚果（JmGO）', conid: '已使用', uratio: '12%' },
                    { id: 18, names: '无线话筒', brand: '麦拉达（mailada）WM8', conid: '已使用', uratio: '1%' },
                    { id: 19, names: '路由器', brand: '华为XD20', conid: '已使用', uratio: '3%' },
                    { id: 20, names: '专业照相机', brand: '尼康（Nikon）Z6', conid: '已使用', uratio: '4%' },
                ]
                // 生成配置的辅助函数，返回结果作为扩展功能的配置参数传入即可
                // 1. 复杂表头合并[B1,C1,D1][E1,F1]
                var mergeConf = excel.makeMergeConfig([
                    ['A1', 'E1'],
                    ['A2', 'E2'],
                    ['A24', 'E24'],
                    // ['E2', 'F2'],
                ])
                // 2. B列宽 150，F列宽200，默认80
                var colConf = excel.makeColConfig({
                    'B': 150, 'C': 200,
                }, 80)
                // 3. 第1行行高40，第二行行高30，默认20
                var rowConf = excel.makeRowConfig({
                    1: 40,
                    2: 30,
                    24: 30
                }, 20)
                excel.setRoundBorder(data, 'A3:E23', {
                    top: { style: 'thick', color: { rgb: 'cccccc' } },
                    bottom: { style: 'thick', color: { rgb: 'cccccc' } },
                    left: { style: 'thick', color: { rgb: 'cccccc' } },
                    right: { style: 'thick', color: { rgb: 'cccccc' } },
                })
                excel.setRoundBorder(data, 'A25:E45', {
                    top: { style: 'thick', color: { rgb: 'cccccc' } },
                    bottom: { style: 'thick', color: { rgb: 'cccccc' } },
                    left: { style: 'thick', color: { rgb: 'cccccc' } },
                    right: { style: 'thick', color: { rgb: 'cccccc' } },
                })
                excel.exportExcel(data, '实验室设备信息报告' + '.xlsx', 'xlsx', {
                    extend: {
                        // 复杂表头合并[A1,E1][A2, D4]
                        '!merges': mergeConf
                        , '!cols': colConf
                        , '!rows': rowConf
                    }
                });

            });
        });

    </script>
</body>

</html>